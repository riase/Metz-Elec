<?xml version="1.0" encoding="ISO-8859-1" ?>
<project name="tests-macros-git" default="make" basedir="../.">

	<property name="git.tasks.macro" location="../macros/git-tasks.xml" />
	<import file="${git.tasks.macro}" />
		
	<!-- Ajout d'un package pour utiliser le task unset -->
	<taskdef name="unset" classname="ise.antelope.tasks.Unset" />
	<taskdef resource="net/sf/antcontrib/antcontrib.properties"/>
	
	<!-- *********************************************************************
  Ce script permet de tester les macros git

  Avant de lancer le script fixer les paramètres d'environnement.

		set JAVA_HOME=d:\Programs\JBuilder9\jdk1.4
		set ANT_HOME=D:\Programs\ant\apache-ant-1.5.3-1
		set GITHOME=C:\msysgit\msysgit
		
		set PATH=%ANT_HOME%\bin;%JAVA_HOME%\bin;%GITHOME%

	*********************************************************************
	-->

	<target name="init" depends="">

		<echo file="${log.file}" append="true">
			La chaine de connexion a GIT est :
		</echo>

	</target>


	<target name="git-clone-pull" depends="init">
<!-- ce test permet de faire un clone puis un pull sur une 
	 branche ou un tag d'un repository GIT distant.
	 La macro prend en paramètre :
	 	1) l'url du repository. Par exemple :
	 		 git://github.com/riase/Metz-Elec.git
	 	2) le répertoire local de destination pour le clone et le pull.

		La chaîne de lancement pourra être :	 	
	 	ant -f tests-macros-git.xml -Dgit.repository=git://github.com/riase/Metz-Elec.git -Dgit.dest=C:\Temp\tmp	 
-->
		<delete dir="${git.dest}" />
		<mkdir dir="${git.dest}"/>
		
		<git-clone-pull repository="${git.repository}" dest="${git.dest}" />

</target>
	
	<target name="make">
		<antcall target="git-clone-pull" />
	</target>

</project>
