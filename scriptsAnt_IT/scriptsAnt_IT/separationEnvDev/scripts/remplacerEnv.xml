<?xml version="1.0" encoding="ISO-8859-1" ?>
<project name="remplacerParamettre" default="replace" basedir="../.">

	<!-- Ajout d'un package pour utiliser le task IF -->
	<taskdef resource="net/sf/antcontrib/antcontrib.properties"/>


	<!-- 
	*********************************************************************
	Parametre d'entree :
		cvs.login.old : login utilisé pour récupérer l'environnement lors de la création duzip
	*********************************************************************
	-->

	<property name="root" value="${basedir}"/>
	

	<!--
	*********************************************************************
		Initialisations
	*********************************************************************
	-->
	<target name="init" depends="">
		<if>
			<equals arg1="${project.disk}" arg2="$${project.disk}" />
			<then>
				<input message="Quel est le disque sur lequel se trouve votre répertoire java\projets?" addproperty="project.disk" validargs="C,D,E,F,H"/>
			</then>
		</if>
		<if>
			<equals arg1="${cvs.repo}" arg2="$${cvs.repo}" />
			<then>
				<input message="Quel est le référentiel sur lequel travailler?" addproperty="cvs.repo" validargs="BDD,DEV,INT"/>
			</then>
		</if>
		<property name="project.dir" value="${project.disk}:\java\projets"/>
  		<property name="cvs.repo.dir" value="${project.dir}\${cvs.repo}"/>
  		<property name="log.dir" value="${root}"/>
		<mkdir dir="${log.dir}"/>
		<input message="Quel est votre login cvs?" addproperty="cvs.login.new" />
		<property name="log.file" value="${log.dir}\remplacerEnv.log"/>
		<record name="${log.file}" action="start"/>

		<echo>
*********************************************************************
Lancement du script de remplacement
*********************************************************************
	Login CVS : ${cvs.login.new}
		</echo>
		<record name="${log.file}" action="stop"/>
	</target>


	<!--
	*********************************************************************
		Replace
	*********************************************************************
	-->
	<target name="replace" depends="init">
		<record name="${log.file}" action="start" append="yes"/>
		<echo>
*********************************************************************
Modification serveur CVS....
*********************************************************************
		</echo>
		<replace dir="${cvs.repo.dir}" token="${cvs.server.old}" value="${cvs.server.new}" summary="yes" defaultexcludes="no">
			<include name="**/CVS/Root"/>
		</replace>
		<record name="${log.file}" action="stop"/>
	</target>

</project>
